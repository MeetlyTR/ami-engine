# Phase 6.3, 6.4, 7 — Uygulama Özeti

Mimari olgunluk eşiğine göre uygulanan iyileştirmeler.

---

## Phase 6.3 — Learning Quality Boost

### Curriculum state generator
- **simulation/scenario_generator.py:** CURRICULUM_BANDS = ("easy", "medium", "hard"); PROFILE_BOUNDS["easy"], ["medium"], ["hard"] (J/H hedefli proxy aralıkları). get_curriculum_profile_for_step(step, schedule) — varsayılan schedule: 1–5 easy, 6–10 medium, 11+ hard.
- **learning/run_optimization_loop.py:** curriculum_schedule, states_per_step parametreleri. Verilirse her adımda get_curriculum_profile_for_step ile state üretilir.
- **Dashboard:** "Curriculum (easy→medium→hard)" checkbox; profil listesine easy, medium, hard eklendi.

### Loss — non_fail_reward
- **learning/feedback_metrics.py:** compute_metrics çıktısına non_fail_reward = mean(1 - level/2) (L0→1, L1→0.5, L2→0).
- **learning/loss.py:** DEFAULT_WEIGHTS = (1.5, 1.0, 0.5, 0.8); L = base - w4*non_fail_reward.

### Clamp test profili
- **config_profiles/clamp_test.py:** J_CRITICAL=0.45, H_CRITICAL=0.85, SOFT_CLAMP_ALPHA=0.6.
- **config_profiles/__init__.py:** clamp_test profili eklendi.
- **Dashboard:** Demo config listesine clamp_test eklendi.

---

## Phase 6.4 — Safety Envelope

### safety_gate
- **learning/safety_gate.py:** safety_gate(metrics) → (passed, reason). fail_safe_rate < 0.15 veya mean_cus > 0.85 → BLOCKED.
- **learning/run_optimization_loop.py:** use_safety_gate=True (varsayılan). En iyi aday gate’ten geçmezse mevcut config korunur; history’de safety_gate: PASS/BLOCKED.

### Chaos / scenario_test dokümantasyonu
- **docs/20_CHAOS_AND_CONFIG_PROFILES.txt:** Production vs experimental profiller; scenario_test ve clamp_test chaos-safe değildir, learning/viz içindir.

---

## Phase 7 — Explainability Layer

### Decision boundary heatmap (J × H → L0/L1/L2)
- **engine.py:** result’a J, H eklendi (selected_scores varsa).
- **core/trace_collector.py:** Trace kaydına J, H eklendi.
- **visualization/plots/decision_boundary.py:** plot_decision_boundary_heatmap(traces) — X=J, Y=H, renk=level.
- **Dashboard:** CUS/Chaos panellerinden sonra Decision Boundary paneli.

### Config sensitivity panel
- **visualization/plots/learning_evolution.py:** plot_param_sensitivity(history) — parametre × fail_safe_rate ve mean_cus korelasyonu (bar chart).
- **Dashboard:** Phase 6.1 bölümünde optimizasyon geçmişi yüklüyken Parametre–metrik duyarlılığı gösterilir.

---

## Testler

- run_all_tests.py: 16/16 aşama geçti.
- Learning testleri: non_fail_reward ve L’de w4 terimi test edildi.

---

## Kısa kullanım

- **Curriculum optimizasyon:** Dashboard’da "Curriculum (easy→medium→hard)" işaretle, Config tabanı = scenario_test, Optimizasyon çalıştır.
- **Clamp davranışı:** Demo’da Config profili = clamp_test.
- **Decision boundary:** Demo veya JSONL ile trace’lerde J/H doluysa panel otomatik dolar.
- **Safety gate:** Optimizasyon her adımda otomatik; BLOCKED ise config değişmez, history’de görünür.
