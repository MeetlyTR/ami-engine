# AMI-ENGINE Dashboard — TR / EN i18n

TEXTS = {
    "tr": {
        "page_title": "AMI-ENGINE Safety Dashboard",
        "title": "AMI-ENGINE Safety Dashboard",
        "caption": "Gözlem ve model testi",
        "how_to_read_title": "Dashboard nasıl okunur?",
        "how_to_read_body": """- **CUS Timeline:** Anlık belirsizlik (0–1). **Soft Clamp:** Clamp uygulandığında kırmızı.
- **Action Drift:** Raw vs final aksiyon. **Chaos Boundary:** Güvenli alan [0,1]².""",
        "model_test_title": "Model testi",
        "model_test_caption": "Tüm senaryo kombinasyonları çalıştırılır; verilerin doğruluğu kontrol edilir.",
        "model_test_run_btn": "Model testini çalıştır",
        "model_test_spinner": "Test çalışıyor (9 senaryo)…",
        "model_test_what_tested": "**Neler test edildi?** Aşağıdaki her satır bir senaryo: state profili × config profili.",
        "col_scenario": "Senaryo",
        "col_status": "Durum",
        "col_cus_avg": "CUS ortalama",
        "col_clamp_pct": "Clamp %",
        "col_error": "Hata (varsa)",
        "model_test_success": "**{passed}/{total}** senaryo geçti. Model doğru çalışıyor.",
        "model_test_warning": "**{passed}/{total}** senaryo geçti. Hatalar: {errs}",
        "model_test_info": "«Model testini çalıştır» ile testi başlatın; sonuçlar burada görünür.",
        "data_source_label": "Veri kaynağı",
        "data_source_jsonl": "JSONL dosya",
        "data_source_demo": "Demo (engine N adım)",
        "jsonl_path_label": "JSONL dosya yolu",
        "demo_steps_label": "Demo adım sayısı",
        "demo_state_profile": "State profili",
        "demo_config_profile": "Config profili",
        "config_default": "varsayılan",
        "config_scenario_test": "scenario_test (L0/L1/L2)",
        "config_production_safe": "production_safe",
        "demo_run_btn": "Demo çalıştır",
        "demo_spinner": "Çalışıyor…",
        "demo_success": "{n} kayıt yüklendi.",
        "auto_refresh": "Otomatik yenile (30 s)",
        "no_data_info": "Veri yok. JSONL dosya yolu girin veya Demo çalıştırın.",
        "metric_records": "Kayıt",
        "metric_soft_clamp": "Soft clamp oranı",
        "metric_escalation": "Escalation",
        "decision_boundary_caption": "Decision Boundary (J x H): trace'lerde J/H yoksa panel boş (engine J/H döndürüyor).",
        "optimization_title": "Optimizasyon",
        "optimization_caption": "Loss ve parametre evrimi",
        "optimization_data_label": "Veri",
        "optimization_load_jsonl": "Geçmiş yükle (JSONL)",
        "optimization_run_now": "Şimdi çalıştır",
        "optimization_hist_path": "optimization_history.jsonl yolu",
        "optimization_load_success": "{n} adım yüklendi.",
        "optimization_state_profile": "State profili",
        "optimization_config_base": "Config tabanı",
        "optimization_run_btn": "Optimizasyon çalıştır",
        "optimization_spinner": "Çalışıyor…",
        "optimization_success": "{n} adım tamamlandı. L: {l0:.3f} → {l1:.3f}",
        "lang_sidebar": "Dil / Language",
        "lang_tr": "Türkçe",
        "lang_en": "English",
        "config_base_default": "varsayılan",
        "config_base_scenario_test": "scenario_test",
        "plot_cus_title": "CUS Timeline",
        "plot_cus_x": "Kayıt indeksi",
        "plot_cus_y": "CUS",
        "plot_cus_mean_name": "CUS mean (kayan)",
        "plot_soft_clamp_title": "Soft Clamp Aktivite (CUS × severity)",
        "plot_soft_clamp_x": "CUS",
        "plot_soft_clamp_y": "Raw severity",
        "plot_soft_clamp_name": "Kayıt",
        "plot_action_drift_title": "Action Drift (raw vs final)",
        "plot_action_drift_x": "Kayıt indeksi",
        "plot_action_drift_y": "Değer",
        "plot_drift_title": "Temporal Drift",
        "plot_drift_hist_empty": "ΔCUS histogram (veri yok — demo context ile çalıştırın)",
        "plot_drift_hist": "ΔCUS histogram",
        "plot_drift_cus_mean": "CUS mean (kayan)",
        "plot_drift_x_record": "Kayıt indeksi",
        "plot_drift_y_cus": "CUS mean",
        "plot_chaos_title": "Chaos Boundary (Severity × Intervention) — yeşil = güvenli [0,1]²",
        "plot_chaos_x": "Severity",
        "plot_chaos_y": "Intervention",
        "plot_chaos_name": "Aksiyon",
        "plot_boundary_title": "Decision Boundary (J × H → L0/L1/L2) — yeşil L0, turuncu L1, kırmızı L2",
        "plot_boundary_x": "J (Justice)",
        "plot_boundary_y": "H (Harm)",
        "plot_boundary_name": "Karar",
        "plot_loss_title": "Loss (L) evrimi",
        "plot_loss_x": "Adım (epoch)",
        "plot_loss_y": "L",
        "plot_metrics_title": "Metrik evrimi",
        "plot_metrics_x": "Adım (epoch)",
        "plot_metrics_y": "Değer",
        "plot_metrics_fail_safe": "Fail-safe oranı",
        "plot_metrics_mean_cus": "Mean CUS",
        "plot_metrics_clamp_dist": "Clamp distortion",
        "plot_metrics_non_fail": "Non-fail reward",
        "plot_param_evol_title": "Parametre evrimi (J_MIN, H_MAX, α, β, γ)",
        "plot_param_evol_x": "Adım (epoch)",
        "plot_param_evol_y": "Değer",
        "plot_sensitivity_title": "Parametre–metrik duyarlılığı (korelasyon)",
        "plot_sensitivity_x": "Parametre",
        "plot_sensitivity_y": "Korelasyon",
        "plot_sensitivity_fail_safe": "Fail-safe oranı ile korelasyon",
        "plot_sensitivity_mean_cus": "Mean CUS ile korelasyon",
        "trace_version_label": "Trace şeması",
        "plot_latency_title": "Karar gecikmesi (ms)",
        "plot_latency_y": "Gecikme (ms)",
        "plot_latency_series": "latency_ms",
        "section_data": "Veri kaynağı ve özet",
        "section_charts": "Gözlem panelleri",
        "section_model_test": "Model testi",
        "section_optimization": "Optimizasyon",
        "metric_latency_p50": "Latency p50 (ms)",
        "metric_latency_p95": "Latency p95 (ms)",
        "metric_latency_p99": "Latency p99 (ms)",
        "plot_cus_vs_latency_title": "CUS vs Gecikme — belirsizlik ile süre ilişkisi",
        "plot_cus_vs_latency_x": "CUS",
        "plot_cus_vs_latency_y": "Gecikme (ms)",
        "download_csv": "CSV indir",
        "plot_level_timeline_title": "Level timeline (L0/L1/L2)",
        "plot_level_timeline_y": "Seviye",
        "live_test_section": "Canlı test",
        "live_test_duration_label": "Test süresi",
        "live_test_start": "Testi başlat",
        "live_test_stop": "Testi durdur",
        "live_test_running": "Test çalışıyor",
        "live_test_run_id": "Run ID",
        "live_test_elapsed": "Geçen süre",
        "live_test_son_1_dk": "Son 1 dk kayıt",
        "live_test_son_batch": "Son batch_id",
        "live_test_reset": "Sıfırla (arşivle)",
        "live_test_reset_confirm": "Eski veriler silinecek. Devam?",
        "live_test_reset_success": "Dosyalar archive/ altına taşındı, yeni run hazır.",
        "live_test_reset_caption": "Dosyalar archive/ altına taşınır, yeni temiz run başlar.",
        "live_test_son_1_dk_all": "Son 1 dk (tümü)",
        "live_test_son_1_dk_filtered": "Son 1 dk (filtreli)",
        "live_test_rate_expected": "Beklenen hız",
        "live_test_rate_measured": "Ölçülen (son 60s)",
        "live_test_last5_title": "Son 5 kayıt",
        "live_test_anomaly_delta_cus": "ΔCUS > 0.2",
        "live_test_anomaly_latency_p99": "Latency > p99",
        "live_test_run_summary": "Run özeti",
        "live_test_clamp_changed_count": "Clamp aksiyon değiştirdi (n)",
        "live_test_clamp_changed_ratio": "Clamp değiştirme oranı",
        "live_test_clamp_mean_l2": "Clamp etkisi (ort. L2 mesafe)",
        "filter_soft_clamp_only": "Sadece soft_clamp=True",
    },
    "en": {
        "page_title": "AMI-ENGINE Safety Dashboard",
        "title": "AMI-ENGINE Safety Dashboard",
        "caption": "Observability and model test",
        "how_to_read_title": "How to read the dashboard",
        "how_to_read_body": """- **CUS Timeline:** Instant uncertainty (0–1). **Soft Clamp:** Red when clamp is applied.
- **Action Drift:** Raw vs final action. **Chaos Boundary:** Safe region [0,1]².""",
        "model_test_title": "Model test",
        "model_test_caption": "All scenario combinations are run; data correctness is checked.",
        "model_test_run_btn": "Run model test",
        "model_test_spinner": "Running test (9 scenarios)…",
        "model_test_what_tested": "**What was tested?** Each row is a scenario: state profile × config profile.",
        "col_scenario": "Scenario",
        "col_status": "Status",
        "col_cus_avg": "CUS avg",
        "col_clamp_pct": "Clamp %",
        "col_error": "Error (if any)",
        "model_test_success": "**{passed}/{total}** scenarios passed. Model is working correctly.",
        "model_test_warning": "**{passed}/{total}** scenarios passed. Errors: {errs}",
        "model_test_info": "Click «Run model test» to start; results will appear here.",
        "data_source_label": "Data source",
        "data_source_jsonl": "JSONL file",
        "data_source_demo": "Demo (engine N steps)",
        "jsonl_path_label": "JSONL file path",
        "demo_steps_label": "Demo step count",
        "demo_state_profile": "State profile",
        "demo_config_profile": "Config profile",
        "config_default": "default",
        "config_scenario_test": "scenario_test (L0/L1/L2)",
        "config_production_safe": "production_safe",
        "demo_run_btn": "Run demo",
        "demo_spinner": "Running…",
        "demo_success": "{n} records loaded.",
        "auto_refresh": "Auto refresh (30 s)",
        "no_data_info": "No data. Enter a JSONL path or run Demo.",
        "metric_records": "Records",
        "metric_soft_clamp": "Soft clamp rate",
        "metric_escalation": "Escalation",
        "decision_boundary_caption": "Decision Boundary (J × H): panel empty if traces have no J/H (engine returns J/H).",
        "optimization_title": "Optimization",
        "optimization_caption": "Loss and parameter evolution",
        "optimization_data_label": "Data",
        "optimization_load_jsonl": "Load history (JSONL)",
        "optimization_run_now": "Run now",
        "optimization_hist_path": "optimization_history.jsonl path",
        "optimization_load_success": "{n} steps loaded.",
        "optimization_state_profile": "State profile",
        "optimization_config_base": "Config base",
        "optimization_run_btn": "Run optimization",
        "optimization_spinner": "Running…",
        "optimization_success": "{n} steps completed. L: {l0:.3f} → {l1:.3f}",
        "lang_sidebar": "Dil / Language",
        "lang_tr": "Türkçe",
        "lang_en": "English",
        "config_base_default": "default",
        "config_base_scenario_test": "scenario_test",
        "plot_cus_title": "CUS Timeline",
        "plot_cus_x": "Record index",
        "plot_cus_y": "CUS",
        "plot_cus_mean_name": "CUS mean (rolling)",
        "plot_soft_clamp_title": "Soft Clamp Activity (CUS × severity)",
        "plot_soft_clamp_x": "CUS",
        "plot_soft_clamp_y": "Raw severity",
        "plot_soft_clamp_name": "Record",
        "plot_action_drift_title": "Action Drift (raw vs final)",
        "plot_action_drift_x": "Record index",
        "plot_action_drift_y": "Value",
        "plot_drift_title": "Temporal Drift",
        "plot_drift_hist_empty": "ΔCUS histogram (no data — run with demo context)",
        "plot_drift_hist": "ΔCUS histogram",
        "plot_drift_cus_mean": "CUS mean (rolling)",
        "plot_drift_x_record": "Record index",
        "plot_drift_y_cus": "CUS mean",
        "plot_chaos_title": "Chaos Boundary (Severity × Intervention) — green = safe [0,1]²",
        "plot_chaos_x": "Severity",
        "plot_chaos_y": "Intervention",
        "plot_chaos_name": "Action",
        "plot_boundary_title": "Decision Boundary (J × H → L0/L1/L2) — green L0, orange L1, red L2",
        "plot_boundary_x": "J (Justice)",
        "plot_boundary_y": "H (Harm)",
        "plot_boundary_name": "Decision",
        "plot_loss_title": "Loss (L) evolution",
        "plot_loss_x": "Step (epoch)",
        "plot_loss_y": "L",
        "plot_metrics_title": "Metrics evolution",
        "plot_metrics_x": "Step (epoch)",
        "plot_metrics_y": "Value",
        "plot_metrics_fail_safe": "Fail-safe rate",
        "plot_metrics_mean_cus": "Mean CUS",
        "plot_metrics_clamp_dist": "Clamp distortion",
        "plot_metrics_non_fail": "Non-fail reward",
        "plot_param_evol_title": "Parameter evolution (J_MIN, H_MAX, α, β, γ)",
        "plot_param_evol_x": "Step (epoch)",
        "plot_param_evol_y": "Value",
        "plot_sensitivity_title": "Parameter–metric sensitivity (correlation)",
        "plot_sensitivity_x": "Parameter",
        "plot_sensitivity_y": "Correlation",
        "plot_sensitivity_fail_safe": "Correlation with fail-safe rate",
        "plot_sensitivity_mean_cus": "Correlation with mean CUS",
        "trace_version_label": "Trace schema",
        "plot_latency_title": "Decision latency (ms)",
        "plot_latency_y": "Latency (ms)",
        "plot_latency_series": "latency_ms",
        "section_data": "Data source and summary",
        "section_charts": "Observation panels",
        "section_model_test": "Model test",
        "section_optimization": "Optimization",
        "metric_latency_p50": "Latency p50 (ms)",
        "metric_latency_p95": "Latency p95 (ms)",
        "metric_latency_p99": "Latency p99 (ms)",
        "plot_cus_vs_latency_title": "CUS vs Latency — uncertainty vs decision time",
        "plot_cus_vs_latency_x": "CUS",
        "plot_cus_vs_latency_y": "Latency (ms)",
        "download_csv": "Download CSV",
        "plot_level_timeline_title": "Level timeline (L0/L1/L2)",
        "plot_level_timeline_y": "Level",
        "live_test_section": "Live test",
        "live_test_duration_label": "Test duration",
        "live_test_start": "Start test",
        "live_test_stop": "Stop test",
        "live_test_running": "Test running",
        "live_test_run_id": "Run ID",
        "live_test_elapsed": "Elapsed",
        "live_test_son_1_dk": "Records (last 1 min)",
        "live_test_son_batch": "Last batch_id",
        "live_test_reset": "Reset (archive)",
        "live_test_reset_confirm": "Old data will be deleted. Continue?",
        "live_test_reset_success": "Files moved to archive/, new run ready.",
        "live_test_reset_caption": "Files are moved under archive/; a new clean run starts.",
        "live_test_son_1_dk_all": "Last 1 min (all)",
        "live_test_son_1_dk_filtered": "Last 1 min (filtered)",
        "live_test_rate_expected": "Expected rate",
        "live_test_rate_measured": "Measured (last 60s)",
        "live_test_last5_title": "Last 5 records",
        "live_test_anomaly_delta_cus": "ΔCUS > 0.2",
        "live_test_anomaly_latency_p99": "Latency > p99",
        "live_test_run_summary": "Run summary",
        "live_test_clamp_changed_count": "Clamp changed action (n)",
        "live_test_clamp_changed_ratio": "Clamp change ratio",
        "live_test_clamp_mean_l2": "Clamp effect (avg L2 distance)",
        "filter_soft_clamp_only": "Only soft_clamp=True",
    },
}


def t(key: str, lang: str) -> str:
    """Return translated string for key; fallback to 'tr' then key."""
    if lang not in TEXTS:
        lang = "tr"
    return TEXTS.get(lang, TEXTS["tr"]).get(key, TEXTS["tr"].get(key, key))
